<?php

use Illuminate\Database\Seeder;

class CatalogsTableSeeder extends Seeder
{
    /**
     * Run the database seeds.
     *
     * @return void
     */
    public function run()
    {
        $scheduled_date = new DateTime();
        for ($i = 1; $i <= 100; $i++) {
            $user = new \App\Catalog([
                'ISBN_id' => rand(1000000000000,2000000000000),
                'title' => 'サンプル本' . $i,
                'genre_id' => rand(1,10), 
                'author' => 'サンプル著者' .$i,
                'publisher' => '出版社' .$i,
                'publisher_date' => '2020-01-01',
                'book_img' => '/images/noimage.png'
            ]);
            $user->save();
        }
        // $isbn_data =[
        //     "9780001971714","9780002110013","9780002110778","9780002112925","9780002113267","9780002113298","9780002113342","9780002114431","9780002114493","9780002116350","9780002151733","9780002151764","9780002151894","9780002151900","9780002160322","9780002160438","9780002161329","9780002161336","9780002161497","9780002161992","9780002163033","9780002167444","9780002167550","9780002168786","9780002171724","9780002175081","9780002175388","9780002175807","9780002176033","9780002177856","9780002178013","9780002178709","9780002179768","9780002179928","9780002180627","9780002182423","9780002182904","9780002190916","9780002190992","9780002191128","9780002194952","9780002254748","9780002550499","9780002550826","9780002555951","9780002556552","9780002558105","9780002558549","9780002571159","9780002624022","9780002725071","9780003000481","9780003700824","9780003750003","9780003750232","9780003750980","9780003831658","9780003832945","9780003833225","9780004330785","9780004332253","9780004334714","9780004334806","9780004356976","9780004586434","9780004588247","9780004588278","9780004705859","9780004707785","9780006169222","9780006172765","9780006174752","9780006177302","9780006267690","9780006326564","9780006326601","9780006326618","9780006327103","9780006330424","9780006331636","9780006334798","9780006335023","9780006338116","9780006338338","9780006339076","9780006341932","9780006357315","9780006359234","9780006366294","9780006369653","9780006369721","9780006386957","9780006432203","9780006531630","9780006531920"
        // ];
        // foreach ($isbn_data as $isbn){
        //     $url = 'https://api.openbd.jp/v1/get?isbn=' . $isbn;
        //     $json = file_get_contents($url);
        //     $data = json_decode($json);
        //     $openbd = $data[0];
        //     //著者をカンマ区切りで並べる
        //     $authors = '';
        //     foreach ($openbd->onix->DescriptiveDetail->Contributor as $value) {
        //         $authors .= $value->PersonName->content . ',';
        //     }
        //     $book = new \App\Catalog;
        //     $book->ISBN_id =  $isbn;
        //     $book->title = $openbd->summary->title;
        //     $book->author = substr($authors, 0, -1);;
        //     $book->genre_id = $request->genre_id;
        //     $book->publisher = $openbd->summary->publisher;
        //     $book->publisher_date = date("Y-m-d", strtotime($openbd->summary->pubdate));
        //     $book->genre_id = rand(1,10);
        //     if(!empty($openbd->summary->cover)){
        //         $book->book_img = $openbd->summary->cover;
        //     }else{
        //         $book->book_img = "/images/noimage.png";
        //     }
        //     $book->save();
        // }
    }
}
